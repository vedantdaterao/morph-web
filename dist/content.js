console.log("Content script active:",window.location.href);async function a(){try{const e=window.location.hostname,{enabled:t=!0}=await chrome.storage.sync.get({enabled:!0});if(!t)return;((await chrome.storage.sync.get(e))[e]?.selectors||[]).forEach(i=>{try{document.querySelectorAll(i).forEach(n=>n.remove())}catch(n){console.error(`Invalid selector: ${i}`,n)}})}catch(e){if(e.message?.includes("Extension context invalidated")){console.warn("Extension reloaded â€” ignoring cleanup.");return}console.error("Unexpected error in runHider:",e)}}a();chrome.runtime.onMessage.addListener(e=>{chrome.runtime?.id&&(e.type==="toggleExtension"||e.type==="refreshSelectors")&&a()});const u=new MutationObserver(()=>{a()});document.body&&u.observe(document.body,{childList:!0,subtree:!0});function o(){return Array.from(document.scripts).map(e=>e.src).filter(e=>!!e)}function d(){return Array.from(document.querySelectorAll("link[href]")).map(e=>e.href).filter(e=>!!e)}function s(e){return document.querySelector(`meta[name="${e}"]`)?.getAttribute("content")||null}function l(e){return Array.from(document.querySelectorAll("link[href],script[src],img[src]")).map(t=>t.src||t.href||"").some(t=>t.includes(e))}const g=[{name:"React",test:()=>!!window.__REACT_DEVTOOLS_GLOBAL_HOOK__||o().some(e=>/react(\.|-|\d)/i.test(e)),reason:"React global hook or script URL"},{name:"Next.js",test:()=>!!window.__NEXT_DATA__||o().some(e=>/_next\/static/i.test(e)),reason:"Next.js __NEXT_DATA__ or _next/static scripts"},{name:"WordPress",test:()=>o().some(e=>/wp-content|wp-includes|\/wp-/.test(e))||(s("generator")||"").toLowerCase().includes("wordpress"),reason:"WP resource paths or meta generator"},{name:"Vue.js",test:()=>!!window.Vue||o().some(e=>/vue(\.|-|\d)/i.test(e)),reason:"window.Vue or script URL"},{name:"Angular",test:()=>!!window.ng||o().some(e=>/angular(\.|-|\d)/i.test(e)),reason:"window.ng or script URL"},{name:"jQuery",test:()=>!!window.jQuery||o().some(e=>/jquery(\.|-|\d)/i.test(e)),reason:"window.jQuery or script URL"},{name:"Shopify",test:()=>l("cdn.shopify.com")||o().some(e=>/shopify/i.test(e)),reason:"Shopify CDN or assets"},{name:"Google Analytics",test:()=>o().some(e=>/google-analytics|analytics.js|gtag\/js|ga\.js|googletagmanager\.com\/gtm/i.test(e))||!!window.ga,reason:"Analytics script or ga()"},{name:"Google Tag Manager",test:()=>o().some(e=>/googletagmanager\.com\/gtm/i.test(e)),reason:"GTM script URL"},{name:"Cloudflare",test:()=>l("cloudflare")||s("cf-ray")!==null,reason:"Cloudflare hostname or meta header"},{name:"Nginx",test:()=>/nginx/i.test(document.documentElement.innerHTML),reason:"Page content hint"},{name:"Apache",test:()=>/apache/i.test(document.documentElement.innerHTML),reason:"Page content hint"},{name:"Bootstrap",test:()=>d().some(e=>/bootstrap(\.|\/|-\d)/i.test(e))||o().some(e=>/bootstrap(\.|\/|-\d)/i.test(e))||Array.from(document.styleSheets).some(e=>(e.href||"").includes("bootstrap")),reason:"Bootstrap CSS/JS"},{name:"Tailwind",test:()=>Array.from(document.styleSheets).some(e=>(e.href||"").includes("tailwind"))||document.documentElement.classList.contains("tw"),reason:"Tailwind presence"}];function m(){const e=[];for(const t of g)try{t.test()&&e.push({name:t.name,reason:t.reason})}catch(r){console.warn(`Detector ${t.name} failed:`,r)}return e}console.log("Detectors active for:",window.location.href);const f=m();console.log("Detected frameworks:",f);chrome.runtime.onMessage.addListener((e,t,r)=>{if(e?.type==="runDetector"){const c=m();return r({url:location.href,title:document.title,metaGenerator:s("generator"),scripts:o().slice(0,50),results:c}),!0}});
